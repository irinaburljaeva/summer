<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–í–µ—Å—ë–ª–∞—è –ø–∞—Å—Ç–∞</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }

    #scoreBox, #recordBox {
      position: absolute;
      top: 10px;
      right: 20px;
      background: #CF2C02;
      color: white;
      padding: 10px 15px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: bold;
      display: none;
    }

    #recordBox {
      top: 60px;
      background: #ff7b00;
    }

    #toothpasteImage, #toothpasteVideo {
      width: 300px;
      height: auto;
      cursor: pointer;
      outline: none;
      border: none;
      user-select: none;
    }

    .shake {
      animation: shake 0.4s;
    }

    @keyframes shake {
      0% { transform: translate(0, 0); }
      25% { transform: translate(-5px, 0); }
      50% { transform: translate(5px, 0); }
      75% { transform: translate(-5px, 0); }
      100% { transform: translate(0, 0); }
    }

    #messageBox {
      position: absolute;
      bottom: 50px;
      font-size: 20px;
      background: rgba(255, 255, 255, 0.9);
      padding: 10px 15px;
      border-radius: 8px;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.4s, transform 0.4s;
    }

    #messageBox.show {
      opacity: 1;
      transform: translateY(0);
    }

    #pinkOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #ffd6e7;
      opacity: 0;
      pointer-events: none;
      z-index: 5;
      transition: opacity 1.2s;
    }

    #resetButton {
      position: fixed;
      bottom: 40px;
      background: #CF2C02;
      color: white;
      padding: 12px 18px;
      border: none;
      border-radius: 6px;
      font-size: 18px;
      cursor: pointer;
      display: none;
      z-index: 10;
    }

    .emoji {
      position: absolute;
      bottom: 60px;
      font-size: 32px;
      opacity: 0;
      animation: floatUp 1.5s forwards;
    }

    @keyframes floatUp {
      0% { transform: translateY(0); opacity: 1; }
      100% { transform: translateY(-60px); opacity: 0; }
    }
  </style>
</head>
<body>
  <div id="scoreBox">–ü—Ä–æ–∫–∞–∑—ã —Å –ø–∞—Å—Ç–æ–π: 0</div>
  <div id="recordBox">–†–µ–∫–æ—Ä–¥: 0</div>

  <img id="toothpasteImage" src="intro.jpg" alt="–¢—é–±–∏–∫ –ø–∞—Å—Ç—ã" draggable="false"/>

  <video id="toothpasteVideo" class="hidden" src="toothpaste.mp4"></video>

  <div id="pinkOverlay"></div>
  <div id="messageBox"></div>
  <button id="resetButton">–°—Ç–µ—Ä–µ—Ç—å –ø–∞—Å—Ç—É</button>

  <script>
    const toothpasteImage = document.getElementById("toothpasteImage");
    const toothpasteVideo = document.getElementById("toothpasteVideo");
    const messageBox = document.getElementById("messageBox");
    const pinkOverlay = document.getElementById("pinkOverlay");
    const resetButton = document.getElementById("resetButton");
    const scoreBox = document.getElementById("scoreBox");
    const recordBox = document.getElementById("recordBox");

    const messages = [
      "–ü–æ–∫–∞ –Ω–∏–∫—Ç–æ –Ω–µ –≤–∏–¥–µ–ª, –≤—ã –Ω–∞–º–∞–∑–∞–ª–∏ –ø–∞—Å—Ç–æ–π —Ç—Ä–µ–Ω–µ—Ä–∞ –ù–∞—Å—Ç—é üòâ",
      "–®–∞–ª–æ—Å—Ç—å —É–¥–∞–ª–∞—Å—å! –í—ã –∏–∑–º–∞–∑–∞–ª–∏ –ø–∞—Å—Ç–æ–π –≤–∞—à–µ–≥–æ —Å–æ—Å–µ–¥–∞ üòÅ",
      "–í—ã –∏–∑–º–∞–∑–∞–ª–∏ –ø–∞—Å—Ç–æ–π –∫—É—Ä–∞—Ç–æ—Ä–∞ –°–∞—à—É üòÖ",
      "–ö–∞–∂–µ—Ç—Å—è –∫—Ç–æ-—Ç–æ –∏–∑–º–∞–∑–∞–ª –ø–∞—Å—Ç–æ–π —Ç—Ä–µ–Ω–µ—Ä–∞ –ú–∞—à—É...–∏ –¥–∞, —ç—Ç–æ –±—ã–ª–∏ –í—ã üòè",
      "–í–∞—Å —Ö–æ—Ç–µ–ª–∏ –∏–∑–º–∞–∑–∞—Ç—å –ø–∞—Å—Ç–æ–π, –Ω–æ –≤—ã –æ–∫–∞–∑–∞–ª–∏—Å—å –±—ã—Å—Ç—Ä–µ–µ!",
      "–¢—Ä–µ–Ω–µ—Ä—É –¢–∞–Ω–µ —Å–µ–≥–æ–¥–Ω—è –Ω–µ –ø–æ–≤–µ–∑–ª–æ! –ü–æ–∫–∞ –Ω–∏–∫—Ç–æ –Ω–µ –≤–∏–¥–µ–ª, –≤—ã –∏–∑–º–∞–∑–∞–ª–∏ –µ—ë –ø–∞—Å—Ç–æ–π",
      "–í—ã –∏–∑–º–∞–∑–∞–ª–∏ –ø–∞—Å—Ç–æ–π –¥—Ä—É–≥–æ–≥–æ —à–∞–≥–∞—Ç–µ–ª—è!",
      "–í—ã –∏–∑–º–∞–∑–∞–ª–∏ –ø–∞—Å—Ç–æ–π –∑–µ—Ä–∫–∞–ª–æ –≤ –≤–∞–Ω–Ω–æ–π ü™û"
    ];
    const emojis = ["üòÇ", "ü§£", "üôà", "üòè", "üòÅ", "üòÖ"];

    let score = 0;
    let record = 0;
    let firstClick = true;
    let explosionChance = 0.15;
    let roundStarted = false;
    let emojiMode = false;
    let confettiUsed = false;

    function showMessage(text) {
      messageBox.textContent = text;
      messageBox.classList.add("show");
      setTimeout(() => messageBox.classList.remove("show"), 1500);
    }

    function showEmoji() {
      const emoji = document.createElement("div");
      emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
      emoji.className = "emoji";
      emoji.style.left = Math.random() * 80 + 10 + "%";
      document.body.appendChild(emoji);
      setTimeout(() => emoji.remove(), 1500);
    }

    toothpasteImage.addEventListener("mousedown", e => e.preventDefault());
    toothpasteImage.addEventListener("click", () => {
      toothpasteImage.classList.add("shake");
      setTimeout(() => toothpasteImage.classList.remove("shake"), 400);

      if (firstClick) {
        toothpasteImage.src = "toothpaste.png";
        scoreBox.style.display = "block";
        firstClick = false;
        return;
      }

      if (Math.random() < explosionChance) {
        startExplosion();
      } else {
        score++;
        scoreBox.textContent = "–ü—Ä–æ–∫–∞–∑—ã —Å –ø–∞—Å—Ç–æ–π: " + score;
        if (score > record && roundStarted) {
          record = score;
          recordBox.textContent = "–†–µ–∫–æ—Ä–¥: " + record;
          if (!confettiUsed) {
            triggerConfetti();
            confettiUsed = true;
          }
        }
        emojiMode = Math.random() < 0.3;
        emojiMode ? showEmoji() : showMessage(getRandomMessage());
        explosionChance += 0.08;
      }
    });

    function getRandomMessage() {
      let msg;
      do {
        msg = messages[Math.floor(Math.random() * messages.length)];
      } while (msg === messageBox.textContent);
      return msg;
    }

    function startExplosion() {
      toothpasteImage.style.display = "none";
      toothpasteVideo.style.display = "block";
      toothpasteVideo.currentTime = 0;
      toothpasteVideo.play();

      messageBox.textContent = "";
      pinkOverlay.style.opacity = 0;
      setTimeout(() => {
        pinkOverlay.style.opacity = 1;
      }, toothpasteVideo.duration * 700);

      toothpasteVideo.onended = () => {
        pinkOverlay.style.opacity = 1;
        showMessage("–û–π! –ö—Ç–æ-—Ç–æ –ø–µ—Ä–µ—É—Å–µ—Ä–¥—Å—Ç–≤–æ–≤–∞–ª... –¢—é–±–∏–∫ —Å –ø–∞—Å—Ç–æ–π –≤–∑–æ—Ä–≤–∞–ª—Å—è –ø—Ä—è–º–æ —É –≤–∞—Å –≤ —Ä—É–∫–∞—Ö –∏ –≤—ã –∏–∑–º–∞–∑–∞–ª–∏—Å—å —Å–∞–º–∏ üôà");
        resetButton.style.display = "block";
      };
    }

    resetButton.addEventListener("click", () => {
      toothpasteVideo.style.display = "none";
      toothpasteImage.style.display = "block";
      toothpasteImage.src = "toothpaste.png";
      pinkOverlay.style.opacity = 0;
      resetButton.style.display = "none";
      score = 0;
      scoreBox.textContent = "–ü—Ä–æ–∫–∞–∑—ã —Å –ø–∞—Å—Ç–æ–π: 0";
      if (!roundStarted) {
        roundStarted = true;
        recordBox.style.display = "block";
      }
      explosionChance = 0.15;
      confettiUsed = false;
    });

    function triggerConfetti() {
      const duration = 1.5 * 1000;
      const animationEnd = Date.now() + duration;
      const defaults = { startVelocity: 25, spread: 360, ticks: 60, zIndex: 2000 };

      function randomInRange(min, max) {
        return Math.random() * (max - min) + min;
      }

      const interval = setInterval(() => {
        const timeLeft = animationEnd - Date.now();
        if (timeLeft <= 0) {
          return clearInterval(interval);
        }
        const particleCount = 40 * (timeLeft / duration);
        confetti(Object.assign({}, defaults, {
          particleCount,
          origin: { x: randomInRange(0.1, 0.9), y: Math.random() - 0.2 },
          colors: ["#CF2C02", "#FFBA08", "#E85D04"]
        }));
      }, 250);
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
</body>
</html>
